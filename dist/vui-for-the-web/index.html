<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>VUI for the web - Huntly Cameron</title><meta name="gridsome:hash" content="8f5d2da4bd612b0bc4d056d7cb77c1bed784ec30"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.13"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="theme-color" content="#4C566A"><meta data-vue-tag="ssr" name="description" content="Voice assistants are everywhere these days, except the web.  Lets look at how we can start to bring this technology online."><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="manifest" type="application/manifest+json" href="/manifest.json"><link data-vue-tag="ssr" rel="icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;👨‍💻&lt;/text&gt;&lt;/svg&gt;"><link rel="preload" href="/assets/css/0.styles.9ab6570d.css" as="style"><link rel="preload" href="/assets/js/app.84a6be26.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.9a006d16.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.df535720.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.a8104a71.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.0c100047.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.6b21d7b9.js"><link rel="stylesheet" href="/assets/css/0.styles.9ab6570d.css"><script data-vue-tag="ssr" type="text/javascript" src="/assets/js/service-worker.js" async></script><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout page-container"><header class="header"><a href="/" class="header-home-link active"><span class="highlight">//</span> Huntly Cameron</a><nav class="header-nav"><ul><li><a href="/" class="nav__link active">Latest Posts</a></li></ul></nav></header><main><div class="post-title"><h1 id="post-content-start" class="post-title__text"><a href="#post-content-start" aria-hidden="true"><span class="icon icon-link"></span></a>
      VUI for the web
    </h1><div class="post-meta post-title__meta">
   Posted 6th October 2019.
   <strong>9 min read.</strong></div></div><div class="post content-box"><div class="post__header"><img alt="Cover image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 550' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-29c482444e186b5d29c0e37d2931d28a'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-29c482444e186b5d29c0e37d2931d28a)' width='1280' height='550' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAcAEADASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAQFBgII/8QAJRAAAgEEAgEDBQAAAAAAAAAAAAECAwQFERIhBhMUIjFBUWFx/8QAGAEAAwEBAAAAAAAAAAAAAAAAAAECBAX/xAAYEQEBAQEBAAAAAAAAAAAAAAAAAQIRUf/aAAwDAQACEQMRAD8A9IgA5rcA5nHktbIWSleW9snj6HuK8pqOtpcU/rLtpPX4/Y%2bTneptqeDCeB5q9yGbycMncynOp3TopajR4PTWvtva/umbsV8UAAAAAAAAAo7fxy2oeRVsxTnOnWntenT6g018uSe9tvvrReAD1q6vanOZmcgABKf/2Q==' /%3e%3c/svg%3e" width="1280" data-src="/assets/static/vui.a209973.734aba349d167e35fbc43cd3664bd682.jpg" data-srcset="/assets/static/vui.a67b0b2.734aba349d167e35fbc43cd3664bd682.jpg 480w, /assets/static/vui.a209973.734aba349d167e35fbc43cd3664bd682.jpg 1280w" data-sizes="(max-width: 1280px) 100vw, 1280px" class="g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/vui.a209973.734aba349d167e35fbc43cd3664bd682.jpg" class="g-image g-image--loaded" width="1280" alt="Cover image"></noscript></div><div class="post__content"><p>Voice User Interfaces (VUI) are popping up just about everywhere these days.  From virtual assistants on your mobile phones, to virtual assistants via smart speakers in your home, to even having virtual assistants in your car.</p>
<p>For some, this is their idea of dystopian hell.  For others, it's their idea of a utopian paradise.</p>
<p>If you're in the business of building for the web and are in the latter camp (or at least someway towards it) then lets look at how we can bring VUI to the web.</p>
<h2 id="vui--vdi-wtf-bbq"><a href="#vui--vdi-wtf-bbq" aria-hidden="true"><span class="icon icon-link"></span></a>VUI?  VDI? WTF? BBQ!</h2>
<p>The title of the post is VUI meaning Voice User Interfaces which is an interface akin to the lower end Amazon Echo Dot or Google Home/Mini devices in that you speak to it, it speaks back to you, and then you rinse-and-repeat until one of you gives up.  What we're trying to do in bringing this technology to the web in its current status is not really VUI in the purest sense, it is more along the lines of "Voice Driven Interfaces", however, you'll just see the term VUI used as a catch-all.</p>
<h3 id="current-sep-2019-speech-recognition-browser-support"><a href="#current-sep-2019-speech-recognition-browser-support" aria-hidden="true"><span class="icon icon-link"></span></a>Current (Sep 2019) Speech Recognition Browser Support</h3>
<p>Speech Recognition API currently only available on Chrome/Edge Dev.  It is available on Firefox, but, only under a development flag and will hopefully be available in the not too distant future.</p>
<p>The speech synthesis API is actually very well supported, but how "natural" it sounds will vary from browser to browser.</p>
<h3 id="introduction-to-the-speech-regcognition-and-speech-synthesis-api"><a href="#introduction-to-the-speech-regcognition-and-speech-synthesis-api" aria-hidden="true"><span class="icon icon-link"></span></a>Introduction to the speech regcognition and speech synthesis API</h3>
<p>We will look at getting up and running from the ground up.  We just want to dip our toe in the water so here is the simplest demo: Pumpkin the Parrot! (<a href="https://heuristic-hawking-e8bb43.netlify.app/" target="_blank" rel="nofollow noopener noreferrer">https://heuristic-hawking-e8bb43.netlify.app/</a>)</p>
<p>This demo attempts to translate the user's speech and speak back what the browser thinks the user has said.</p>
<p>The code for this app is fairly straight forward and can be viewed here: <a href="https://github.com/huntlyc/Pumpkin-The-Parrot/blob/master/index.html" target="_blank" rel="nofollow noopener noreferrer">https://github.com/huntlyc/Pumpkin-The-Parrot/blob/master/index.html</a></p>
<p>Here's some code used to start the speech recognition service and keep it running:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> recognition<span class="token punctuation">;</span>

<span class="token keyword">try</span><span class="token punctuation">{</span>
    <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">SpeechRecognition</span></span> <span class="token operator">=</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">SpeechRecognition</span></span> <span class="token operator">||</span>  <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">webkitSpeechRecognition</span><span class="token punctuation">;</span>

    recognition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeechRecognition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//Set lang to english</span>
    recognition<span class="token punctuation">.</span><span class="token property-access">lang</span> <span class="token operator">=</span> <span class="token string">'en-US'</span><span class="token punctuation">;</span>
    <span class="token comment">//Set to continually run (your mileage may vary)</span>
    recognition<span class="token punctuation">.</span><span class="token property-access">continuous</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">//Wait until user has stopped speaking before sending off for analysis</span>
    recognition<span class="token punctuation">.</span><span class="token property-access">interimResults</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">//Try and just get the best possible match</span>
    recognition<span class="token punctuation">.</span><span class="token property-access">maxAlternatives</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span><span class="token punctuation">{</span>
        recognition<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        recognition<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">onresult</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            <span class="token comment">//service stores history of all our results, grab the latest</span>
            <span class="token keyword">const</span> userSpeech <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token property-access">results</span><span class="token punctuation">[</span>e<span class="token punctuation">.</span><span class="token property-access">results</span><span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">transcript</span><span class="token punctuation">;</span>

            <span class="token comment">//You've now got what the recognition service thinks the user said as a string</span>
            <span class="token function">alert</span><span class="token punctuation">(</span>userSpeech<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// already started, try again</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">setTimeout</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> startSpeechRecognition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/**
        * There's no easy way to detect when the
        * browser has killed the session and stopped
        * listening in on the mic.
        *
        * So attempt to restart the session on
        * each audioend event.
        *
        * [Fired when the user agent has finished capturing audio].
        **/</span>
    recognition<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">onaudioend</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">startSpeechRecognition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Sorry, speech recognition is not available for this browser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>We create a "voice loop" in the code because the browser can stop listening at any point.  </p>
<h3 id="making-vui-easier-with-annyang"><a href="#making-vui-easier-with-annyang" aria-hidden="true"><span class="icon icon-link"></span></a>Making VUI Easier With Annyang</h3>
<p>If you look at the source code for that parrot demo, you'll see that there is a lot going on for such a simple application.  Also, just throwing back what the user has said isn't very useful.  If you want to act on what your user is saying, then you had better sharpen up your JS regex skills!!!</p>
<p>Thankfully, the annyang library will effectively abstract out speech recognition implementation details and act as a mail man between your app and the browsers speech recognition API.</p>
<p>It also allows us to trigger a specific function if the returned speech matches a certain phrase.</p>
<h3 id="annyang-demo"><a href="#annyang-demo" aria-hidden="true"><span class="icon icon-link"></span></a>Annyang Demo</h3>
<p>Before we go into the implementation details of annyang, here is a demo of an evolution of our first parrot demo where now instead of repeating back what we say, we instead can ask it a few simple questions:</p>
<ul>
<li>What's your name?</li>
<li>How old are you?</li>
<li>Is pineapple a good pizza topping?</li>
<li>What's your favourite [Pizza/Ice Cream/Drink]</li>
</ul>
<p>You can view the demo here: <a href="https://heuristic-hawking-e8bb43.netlify.app/annyang.html" target="_blank" rel="nofollow noopener noreferrer">https://heuristic-hawking-e8bb43.netlify.app/annyang.html</a></p>
<h3 id="annyang-basics"><a href="#annyang-basics" aria-hidden="true"><span class="icon icon-link"></span></a>Annyang Basics</h3>
<p>Now you've seen the demo, let's touch back on what's going on here:</p>
<p><strong>Setup</strong></p>
<p>This is straight forward, we include the annyang cdn script into our page and then, in our JavaScript, ask if annyang is available.  If so, it means that we've included the library correctly and the browser supports the speech recognition API.  If either of those things are false, we won't do anything.</p>
<pre class="language-html"><code class="language-html">    <span class="token comment">&lt;!-- ... --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>//cdnjs.cloudflare.com/ajax/libs/annyang/2.6.0/annyang.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">if</span><span class="token punctuation">(</span>annyang<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// do speech stuff</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'speech recognition not available on your browser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre>
<p><strong>Adding commands</strong></p>
<p>Annyang commands are a phrase/function pair and we group these pairs in a literal object</p>
<pre class="language-javascript"><code class="language-javascript">    <span class="token keyword">const</span> commands <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'Whats your name'</span><span class="token operator">:</span> sayName<span class="token punctuation">,</span>
        <span class="token string">'How old are you'</span><span class="token operator">:</span> sayAge<span class="token punctuation">,</span>
        <span class="token string">'Is pineapple a good pizza topping'</span><span class="token operator">:</span> freakOut<span class="token punctuation">,</span>
        <span class="token string">'Whats your favourite :thing'</span><span class="token operator">:</span> favThing
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">freakOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">favThing</span><span class="token punctuation">(</span><span class="token parameter">thing</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>annyang<span class="token punctuation">)</span><span class="token punctuation">{</span>
        annyang<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        annyang<span class="token punctuation">.</span><span class="token method function property-access">addCommands</span><span class="token punctuation">(</span>commands<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>We can then pass our command object to the annyang <code>addCommands()</code> method.</p>
<p>In the case of "What's your favourite [Pizza/Ice Cream/Drink]" we can tell annyang to extract the "thing" being asked for into a variable.  This avoids us repeating each iteration of the command and allows us to easily add additional favourite things by just editing the associated function.</p>
<h3 id="the-standard-vui-flow"><a href="#the-standard-vui-flow" aria-hidden="true"><span class="icon icon-link"></span></a>The Standard VUI Flow</h3>
<p>Once the microphone permissions have been granted and annyang is started, it will continuously sit and listen for commands.  </p>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 149 371' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-89399c5370e1d7556d7aef7acb7e9c23'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-89399c5370e1d7556d7aef7acb7e9c23)' width='149' height='371' xlink:href='data:image/svg%2bxml%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAACfCAYAAABJAd8kAAAACXBIWXMAAAsTAAALEwEAmpwYAAAR0UlEQVR42u2de3AURR7HN7sLBEICgQgC4nmnZ7SuopbeH3fnHVDy8DCedVahnugVFSKl8SJnILwS3r5FUXkqKiAYRMUXQkQFFQXFVxQFRQTxhcQXylsS2L7%2bdKb32s3O7myys5uQ7aofM0xmuvv37V9PP%2bb7%2b62nd%2b/e4rbbbhMTJkwQkyZNapYi6x649dZbxcUXX3zQ4/Ec56lLaR4nCeWPgRTgn6eeeip2AGh50oEDB0RNTU2zlIMHDyoAFixYEDsAmBCJjJprqq2tVQAsWrQoBUAKgBQAKQBSADQYgEAgUDeoyqN5fuTIESXmNdsB2Xj26NGjv7qXc1lZJfwt9P6og32YvBFZ94YDMHHiRJXhoUOHgsqalQuDdhAME5jQc%2b4znwmXF%2bWYz2lgEP2MPtfXzfqFToQWLlx4SKrUxVLN7wiEG264ISzav/zyS7Dyr7zyilixYoUCKZb05Zdf/qprHT58WDz99NPikUceEVu3bm2U2X/11Vcq73379omvv/5aAfD4449jAZ09saSCggLx8ccfq0r99NNP4tVXXwVJMXr0aFXQsmXLxN133y1ef/11sXHjRgXEk08%2bqQrfsGGDWLVqlbrvjTfeCJ6/%2bOKL4rnnnhPz588XN910k3j77bfV9U8%2b%2bUSMGzdOfPHFF2LMmDGqPJ5555131N%2bXLFki1q1bJz7//HPxwAMPiB9%2b%2bEE9Q33effdddV9FRYX49NNPVX3uvfdeMXXqVPHee%2b8Fdu7cKYYOHVojVfpN%2b/bt/ySPl0npHrU7MBX%2b4IMPxOTJk8XSpUvFtGnTxEsvvaSUJu3atUvMmzdPPPbYY6pyd911l1izZo244447BAsQ1hL33XefuPnmm9X53LlzxUMPPSSo0KxZs1SLT58%2bXZkzFjF8%2bHD17KOPPqpAmjJlinru/vvvF8uXLxdbtmxRdUDZO%2b%2b8U10H9Ntvv13MmDFDPPvss6o8npdTX1WGPAbk/2vJV6pU1rZt2//I44VSrrTU9NkCUFJSIhYvXqyQJAPQpgWoBAnkP/vsM/Hwww%2br1sNSAIBK032whsrKSlFWVqaURQkA2717t8qPFqSSdCXO77nnHpXngw8%2bqCyFBuBIHXh2%2b/btCtjNmzerMrCEtWvXipkzZyqLousABPdjMTSItISAbKBarkuVJmdkZFwuj6dLuToqAJdeeql4/vnnFbIosn79etXXsQaOsn8pU5MrLWUppaWl9DUWIOK1115TStMdOOceFKXFaKE333xTWRBdhRcXJk1XIWH6P/74o1KaZ3k/AMrLL7%2bslAS0b7/9VlkdgKDchx9%2bKL755huV7/vvv68ABSDZhQMAN2TIELrA77Oyss6Ux%2bOlnB21C9x4442OXzwUjnLRhsJoKcxb3DbR%2bnQFrCbacth6CXYKUTHN8TCohxg9lOlx1m5YizQMmnmZY7ZW3u650GHQHJH0ffoefZ%2beB4QMg15Hw6CTmaDdBMm13Y0w5UWZm7g7FU40AOHKjFRuai2QAiAFQKMWQzwckG/agHzLNkuRcwgFgJyBxg6AnMIyvrktRyxxs4yAnAfsixmAoqIiNduTCwo102qOQt1ZZzCdlyp1jQkAmfq7KOdLOVfKf6WUS/mzdc2NsgZI6Zudnd3K09SS3%2b8/w%2bfz9UlUeXIx5Pzm9PR0n0TN17Fjx7iLXJbq1virlH9Y5bV2oyx0aNeuna%2bpNb7XOv5FygVRl6bHYEoBkAIgBUAKgBQAKQBSAKQASAGQAiAFQAqAFAApAFIAtDwA9Mbk3zzWjpAnhs3KYyHpLbE8CwRSektr/VIpi6QskDK1ydVy7dq16titW7e0s88%2b23fGGWf44yE9e/ZsrTq8zwdLg/164fV687nWvXv3NvEq55xzzvGdeOKJwW7Vrl272EG44oorvC7jPFPKM24WMGXKlKAOMW2LV1VVafS6ZmdnX9alS5ehOTk5Bccdd1yjReZT2LVr139lZWVNy8zMnCPPL%2bNaPPI25ApZ95NQQAjRMPSk0gXTp0/fDf8OYlJ1dbU6NmXRddyxYwe0uQOnnnrqaAsE1aBXXnmlY/0HwPSyUo1Loj%2bOupW/Yp916NBhCAr179/f%2bVyjoKDgTYt6UsOnZot8FLBENFEJmCLrrRhc5eXlG/Xkq3379s4AmDx5MuyjgEWQCATcJv/El0ekuA0GQeKAx/o83rp1a8cMkYDFEGlWypsgNJYiYwIgmiEAokUDkCJJxRsAO1JkqOtLOOJiLOTGWEw8GlEzrj5Ddkqb10zub6jYVTrStWigR7o/AgC%2bBneB0FbV4280WmsoEzyU52tnMZoIHe08nFWEAeB4Q73uFhBe6%2bgzNmnCW4AuEJ8AXFtIuLzA59%2bzZ49ibuNDxPHnn38OVoS/aRCZpuJBsn//fnVdM775v2ab4ztA2rt3b9AXifwoR%2benWeJcp17UCUZbKIAhAGTk5uaeII%2bPSrk8ylK9PgCaFo8nxqZNm9Q57jLPPPOMoqHhUFFcXKy8NfD%2b4DqOEjg14NFBwu/ommuuUV4muLrg4EA5mvOPjwIOFStXrlReJzyHPxJOEbjB4C2iz/FnuuWWW8QTTzyhysfFhjJN69AAVFRU7JUqzfP7/cJaguM6UyBlmJRCKcVS8n8Fgh0Ac%2bbMUYsN0uzZs5XieHS88MILym0GJQAJjw3updL4C/E8FsDf8TrBMYpK43WiWx9HLIT7URwfpeuuu0656ZAfCmNBnOM2wz0kXHBw38GbJBwAixcv3i9V6pWenn6LPO6R8m9mxVJ6eOr8CH4npcwRADhNUQmcl1ActxYcmACD1uGo/X9QFHcafIXIg0qiMBbAPbQ0eZBwtcFNBmXwBKEMgMBqAGD16tVKYSyKc1xj8DzDyrgPNxnKCQeA7AKHLIVJf5DSN4zpF0UEQPcr%2bh3K4YtDcAXko48%2bCr4L%2bDtLUfoyfZjr%2bPBZnpzBPr9t27ZgX9d58xyWgfMVraz7OmxP/AG1XyD/J%2bHE9f3336tytK9ghHdAV9v%2bXrcfWWwLQLi3czydH0LPeaGhmO4a4UYSu9HHwTzAF2YuEBmA0DFWD39243%2bk%2bUC4e8zKhxvqTF/jcOcxzgPCTYScWUAiFjBasUi%2bQC5MhcMC0JJWg1EBONb3A%2boDgM%2bw3hEKBJoXBtb7IGDMA4J%2bg2kyOQJgzJgx31kWcFRn2NSBMOtpNd5Ra8JWLVXKsvYEnQGQl5d3Az68TNflC%2bmIGyIT/xx1K3%2br7qJfv37z0KmystIrk8cRADK1GTx48BpzkdHcEp7qRUVF70tdcqLsBYQFgOQ/%2beSTry8pKXmlrKysauzYse%2bOGzeu0UI%2bMr%2b3RowYsUXmva28vPwtea0qXnlzHDVq1PqzzjprgjEFVk0vF0SOAUjE9/o/eur8ehJCyDjttNM8sVqAZ9CgQT4%2bK8VZ1K5Mdnb2uVlZWUR08MgVpj/e5Ujz9%2bm3fm5ubiSA6gPQpk0bj/UhIbavqrFTZPLdoMhQ57Zt23ocfg2yt4AWwhFKAZACIIkA5LdkAP5sAOBtSQDQ2qd46vyHmQf8VkrblgKAz6DJ7ZCyXcq0JFtBQgHQBdDiu619%2bh4tAgBjKa6tYITR%2buqazWrt2HoHDBs2zG/NNgsyMzPHcL506dLgKJAEENwFwFRIrtL0cix/yZIlAb7%2byPOruLB58%2bZkgeAeAHbK831Pb%2bQQtE0uU%2buBYLN0bZ5dYOTIkfWUZ9emtrZWbVvZgZAgS4g/ANFaHuX1/iLbYhoEn8%2bXDBDiC0AMygd0yLtoILjcHdzpAnZmr5U3dpnrgZDg7hAfAGJpeXN/XW9jJ7E7NB6AhirfEBBc6A7x6wJOzD7Kx9FkdIeGA9DYlm%2bMJcQRhIYBEG/lk9gdGtcFSktL46Z8Q7qDBCaxAJgfWCMp/6txzgaDKAzQRHUH5wCYaNuZvRHTN2BHaXUiFgUmiKOL3cE5ANoDa%2bzYsV475ffv36%2biOcIGC215J0SnCO%2bF0O4wzKpTWkK7wHnnnaeVH6h5fmafX758eaCwsFDx%2b2B7QV9DvvvuuyAnULPAOIcqB%2bES5iisML7qcl1HpScMd7hpM0HYMzMzC62u6E0IAB07dtQF5UFatMhImsumYnlqQiU8P9iiECZRBpYoSkKG5O86Gj30WGi3Opa5JkYScZ7r/B9SpZm/tDBAOAo111MXjNFzwgkneF0HwPhO6OvXr98sfAppFE1H0RWE7QnBAgAgNhIpHgDoLlQavjFcYGKE89sARIWH68sGyfjx41V0eoApLy9XYfMhTgKAFTabMmrI/5JLLllGtahQdnZ2wobB4E1nnnnmDCiwliEErH4dIOw9pgwtFiYp1kJr85sCsLuhvS5atEhFjYf3qy2Fv0OB5bcIsBLor1BhJWC65ZXyMFIHDBiwLFydXAUgPT3o5Z6mX4ihIFh9W4FBXyZBgaXfQ6flmhX8XBGoEf07IVBsEV6gPAMVd8eOHQEryHtQ%2bf79%2by8L/dAi3weJsQA%2bmUcCQUd1N4fBxnCfrJdsROWNhknMTNApCHoMb6AEjJ/LsVW%2bU6dOyZkKGy/EiN0hVnqdMQsMvvDslO/cubMnDqnha4FolhArCLEo30izj99iKF4gxKJ8I4Y8dzZEGtsdkmD28d8RaqglJMns3dkSixWEJJq9e9viMXaHZJm9u98FnFpCEs3e/Q8jTkCwFpK2ysvVZ/P8Nui0O0RSPicnx5Og5O7XYU27NUHIy8ubgQ8yi52%2bffvWU17TXI8JAEitWrWqB0KvXr3mn3/%2b%2bStDle/QoYMnwSkxFBlzM8U6Ek9Mu7H6E2z2iQdAdwdpDV7r/Fz5orzQ2m32JtjskwOAaeqeOqJki6bK8hugF4RcaxEA0Nq4sfeW8ndP3c9gNi2qrO6PzMLi7DFikiR3Sdkp5fZ4WwEBFOPiMTJw4EB8hrxxFAXA%2bPHj2/j9/m/ly0/k5uZ241p1dbU/nmUNHjw46Cp/0kknecI7jdoDkIi%2bcJ2UWxNQjtLllFNOidkC0nr06HH1tddeu2rEiBHrS0pK1sVLZH6vFhcXV8m8N44cOXKtvBbX/IcPH7769NNPL/X8P1ptmjXcOgbAP2jQoJWEymiuie8NhYWFb7GmimLV9QGQ6E20osUcxhHbTf9hmWrd8h0mhkmfPn1mo1NFRYXX5j1QH4BRo0ZVm97jIfsXTdp7XH9M0d7jM2fO/EaqlGmNCKn4AY4AaPERJFIxRFpWQMUUAJ5YIkmZgZAiRZOMFHwxUnBEJ3Q6J5EpXbGA0CCJ5q/Jm78Ub56bvx5vXgtVxvy1%2bdD8QoM36kbQf3cQULFLXC2AWVayXm6aYWbXMDYAZEfZnyhyDACIw%2bshViDkJ8hKhNKrqqpSkeaI8sZWNxEmIUPB/mJWSQQ5wvAREQ5aHDQYytF0GO6HHgNvCOocisIWI7%2bdO3cqeg3PQ66CgwTjbN26dcLaYo9kAcwDci%2b66CJC6bDp2NkQgCHS5DjHAPAxA1ITARFheEFoIo4gdDYdD5AYgzC7ID1BdaPSEKVgf3EP5zxnTbjEihUrFIgLFy5UgRPJj2e4F0AoB4WJR0gUSfKFREUd%2bJHl0EBrJgAyzxqpUmlGRgbs0mukXG0IZMvrpfzTMQD0O0JiojCtA5MLShsVxzLg9EGHwyJQcuvWrSraI622ZcsWIafZSiEocVwjEUwRqyDQIvcS2R4KHkRMrmmuIfdTFuDCNINyZ5A1I70DMpwumx11AQiNVBoOIFw/TJWWoaIogqmiOC02YcIE1XoQI6HOESUSgDB7jrxP9M9lkx/PEDOUoK1YwoYNG1TenJMH1ysrK5XiAEw4TwcAHG9sv3tDJHJU2Wgvm0gJBVHaaWDFeAVojHEYrJ%2bczAM04qFx/s15As%2bbQ1m4Z83Wi5RvODHziDIMJj62uF3IzCY4EwwLQIMXQ07ifh/TADTD1WBUAFreL0zICYoOSthgx6dkKh8CwAG9FnD8GyNXXXXVO9bbudZanASa2a/MBB05Jk6cuEl/kYqFUX4hkw2Tsd3cegH/sDbJyclRvkX5%2bfmxfYHu2bPntXPnzv1JLl6OyMVNQM7ctIgmKqp%2b1HXXrl1HCaqel5c3CV00K0U4/Nmt/wF4Hu7f4ZA0mQAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="149" data-srcset="/assets/static/stdVUI.39281a1.d0c22e60c5e3ca8a7a2f7c33e03d8036.svg 149w" data-sizes="(max-width: 149px) 100vw, 149px" data-src="/assets/static/stdVUI.39281a1.d0c22e60c5e3ca8a7a2f7c33e03d8036.svg"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/stdVUI.39281a1.d0c22e60c5e3ca8a7a2f7c33e03d8036.svg" width="149"></noscript></p>
<p><em>Standard Speech Recognition Loop</em></p>
<h3 id="a-better-vui-flow"><a href="#a-better-vui-flow" aria-hidden="true"><span class="icon icon-link"></span></a>A Better VUI Flow</h3>
<p>A standard VUI loop may be what you're after, but likely it will be more annoying than it is helpful.  The solution, a keyword trigger.</p>
<p>In the same way as Amazon Echo devices have "Alexa", or Google's assistant/home devices have "OK Google", you may find that it's more beneficial for your user to first trigger your VUI and then speak their command.</p>
<p>The flow for this would be:</p>
<ul>
<li>Start annyang and only add one command: your trigger command</li>
<li>Once triggered, add in all your additional commands</li>
<li>Once done, or no speech detected, remove these commands so we go back to only having our trigger command</li>
</ul>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 396 826' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-8abd7a772622097f678e217cf608dec7'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-8abd7a772622097f678e217cf608dec7)' width='396' height='826' xlink:href='data:image/svg%2bxml%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAACFCAYAAADrTP7ZAAAACXBIWXMAAAsTAAALEwEAmpwYAAAVYElEQVR42uVdCVwVVdu/G%2bDuKyAuiQsur69ZtmlvJUp%2bilJmRpqfuHylJKWv5s80y1wSN0RRcslcUpBFlB0EVxQB9yXcECyUXFpMCRcUuJc77/M/zpmGy0XvJT69Y/P7PczcmTOHOf95znOe7ZxRqR7hJgiCBvvVq1cvvXr1qnD69Gn9mTNnhOoQ3Vv%2b448/CsnJyYUNGzasi3qDgoJUNr1xANLS0pYK9ze9UP2tHH/y8/MLHR0dGQBxcXE23X41Pa8OBykpKQyAsrIyvcFgEKoivV5v9lj8zQAgbihs0KBBfdQ7YMAAtUoJW0ZGxqKa4oALFy7c8PDw0Cmh3U9TX%2b1G%2b1bTp08PuXXrlnDkyBH9%2bfPnhR9%2b%2bEE4e/YsGiMcPXpU%2bOmnn4S8vDzh%2bPHjAmTF999/L2zfvl1A2YsXLwro%2b5cuXTLiWlRU1B2q00OtVrfRarVudGxvqwB0rV279ju0Hzp69Oj0GzduCDExMYZVq1YJO3fuFBISEoStW7cKiYmJDITDhw8LYWFhTOBlZmYK8fHx7DqAwHF4eLgRx/Pnzy%2bmOocTAIOJ/k3HjrYsBFWiEFzMeLi8XH/nzp1q8f%2b1a9fkQrCWIvo%2bHwVSU1OXiACU0M7AN/rNSH5s7jeIyw/qOtednJzYKDB58mS1IgDYvXv3CqGGNpIH94gD6qHe2NhYZXBASEjIlIKCgov08CeIhU%2baEgnDbBKCZ3Nzc3NwTOdOmZahe7NJEJ7dtWtXFgnX2qh3%2bfLlKqVsWlFamyMH6AxELYjaiOUdHlDeTvUkbp07d27s5ubWXPU33Lgga0r0lHis%2bTsC4UTkpvqbb888Ua3p06ePpAzNmzdPHRAQoCFNTrNgwQKJvv76a42Pjw%2bEpKpu3botSWvULlu2TLNw4cIK5XBfYGCgZubMmaw%2bUpdVzz//vG0DcP36dbbPzs62RGFpRPSJJfUGBwez%2bqKjo22fC8gUZg9Lb6v5yJEjewwbNuzV4cOHv8aJ3n53X1/fbr179x5Io8D6ESNGsOtU7jV5Ofyma6%2bBUeQg2PRGbM%2bkuZ%2bf37Okwt4glVa4e/eucO/evUpUWloKXf%2buuWsg3Gc0GmEoHRD1BNWnn35q2wCQpcfs9i1btowTNdlScW80Q8IDrklliouLBQ8Pj%2bdQ7/jx4217uCRzVifq7GM4AEZxI26QSH4ODTV3vRzsQ9utW7dKu3fvzgDw9va2bQCSk5MZADExMX4iAGViI6vcqCtUdYndd/PmTb2np%2be/5Oa2zQOwefNmBsDly5fLfvnlF%2bb8gHODrETh5MmTwrFjx4R9%2b/YJ586dY7/3798vZGRkMMcIvEPwFO3cuZMBQJbyTTKHv6FqP3RwcGgFzxPRvx5AHYk6EbWVaZ2PFgCSAQwAanzZqVOnjAcOHGAAbNu2jTUYLi%2bc4y4weIlAaWlp7DwAOnr0qBHO0ZKSkrs0WnjL1GatqDpXRVqxXHuiBo%2brC3AZUGZG6FX2ft7v7oIZwSgUFRXpvby8/ol6Bw4caI0MgJpd/5ECkJqaygCIj48fKzakWPTs6EmuMeK/%2bTnT3/wc7QGegUaBMhoFXkS9kyZNsoSl1TIAHi0HrF%2b/nrEfqbaDasojVFBQUEpdwBX1Tpw40bYBeO655ySHSHh4%2bFQSbDHp6ekRRJtMiYRgJPX7FHPXiCJxfe/evdFBQUGDxBFATRqiyqYBqMbWzBpvs5X%2bhkcPwEcffcT2L7zwgoqGNC1JeR0Ndbrc3FyJcC4rK0sH/6GLi0unQ4cO6fLz89l5eTlQXl6eLiEhQcNBoC6gfA5o2bIl27u6utqROdzNzs5OJ5rGNe1xsj0ASEjKHxAO0UVDhw6VnJ4WvmFlAhAaGsr206ZNYyNF%2b/btm4wdO3Yuv96jRw/24JMnT37yANi4cSPbf/XVV1xLq0VyIB3DXFRU1CLex8noYQ8/derUJwcA/ubljachLkOmKQKEIA6Cu7s7a8Dnn3%2bufADEPl9l40nXh7prqAqEanKCbQDABRr1aa6/1yIFJ0NmJjOPjxyETZs2SSC0aNFCLcoK5XLAxx9/zB/GgbS6CmxvYiRJIERGRi7%2bi7a/bQAwatQofmi/e/fug2gcmbhlR44cEUjJMebk5BjJVIbtb8Q5MoONhYWFDJywsDDOCWriBGUCINPb1UlJSWvQsKtXrxpI%2bhvJaoR/AHsj2QNGZIogm%2bTXX38Vbt%2b%2bLaxYsWIMB%2bDpp59Wbhd48803Jetty5Yty2SJU3LWFzj7I6/I399/GG%2b8orvA%2bPHj2b53795mQYDwE4UgazxyiubMmcMbz0cNRJGVywHcj%2b/p6anmQi06OpqDYOCNp74vzJ07t1LjX331VeUrQlyh6du3rxyE5dzhgTc/b968mmq8barCX375ZSUQSPgth9ALDAz0qcHG264xNH36dLbv168ff0DNiy%2b%2b2N9U4P3Fxj9eAN5//325DaDds2ePLi0tTSLSB3SkDepo2LMX84o7LF68uM6xY8ek6/LyO3fu1AUHB0sOER8fH2VwgIVaXEOi2ZYU3LFjB2tUdna27QPAG09vbhApOnO3bt06k2iWnLZt2zZj8%2bbNC2bPnp1ICtEM0%2buglJSUmaRA%2bZMtgfRY1aFDh9Q23wVWrVrFBFlAQEA/KDU1sZ07d%2b5GvXr1XFCvzccF6K0x/15cXBwPj98RjZ%2bqyPCAa4ia6ouLiw2vv/76C6jXz89PY9MA8NAYjfNWhcakeJjRKDs08uhwmbu7exfUO2bMGGUAIA%2bPl5SUGBECx4wQtKmsrIzt8RtZIH/88Qc75vFBHMMg4gBQVyrr0aOHsgAgDvATX2MZ5gkg6rty5UqBBB8LkWM%2bwOrVqwUSbAINl/AGSXMFyF4QvvnmG8wj4MFR5QEg5wAygY2//fYbC4kjHI7wOGaCFBQUMDUYHHD58mUBZTCzBISZJdeuXZO6AAdAMTKgivB4dYilyChOBsTGxvJR4B4mP1BXqA7Bb1COJKlevXo9L7rYbBuApUuXakQLsDtYvCa248eP5/OGkHlt23qA3LAhpaUraYPvBwUFDSMabo4mTJgwlWyBEUuWLDF7nc6P8Pb2Rl4Qki9sXxPkarAVHl1XSwrt2rWLNSonJ8e2AfD09JSOaWjT5OXlaakraKgBOjOgYDZI56qAhCVJo4aGp8jinIXJ0rbhD3jjjTfYfvDgweyBXFxcGtEYv4gsu6/37t278Ntvv42dM2fOIToOJONoKdESMn%2bX0ggShNkkuOeDDz5gMmXAgAHV9wcgr2bDhg3aTZs2aSMjI6tFuBdp7s2b35/h4uvr%2b8AnoGFL3h3UYh/eZKngI46JM3WUeHh4PH6HiJyNa9UyP5cRiQ5ZWVnsmBQdNiyuWLFiAk8MpWGxDEMcny8oHuv5nucXr127dgrupSKsDupKqgYNGlgPQJ06df5BknYIsZwPqZjVoaGkto6kIainJf%2bdBzTXrVvHTOMRI0Z0u3LlSrmYD1jOLR0zhpBRXgb%2bQhr33VEHuBB7f39/6wEgPTxL9EELPCBpDXEjBfY9gcG8tzQ2a6viAJ1Ohy7AFZb62dnZP4j/H29YEJOhpbo5ib8rxApOnz5doLo/sULl5eWlsbILtMP/V0H/Fu3u6hIQwBRY5O8uF7uCxs7u4dP5SLBFPSAgWlWCtFF%2bD8mD%2bGr22KeY2%2b3s2bNogFGMxEh6tjw9nZ9DGfl5/htvDw%2bTkpKyhAMgQ1onviVGbm5uzrS3I%2btvKo8CwSQmIwg5w0YYOzCGkCMMaxDT6KE14lxubi4LnKIszGI%2bf5i6EyYO2bVr185Z/r%2bqIPga/4/oTTbUojJ5HA6sLFYubXxWxwPeCrshIyNjsal0pg1DQ1cR8daOjo7oe86kFk%2bRxf2MBJ6RRhMjjUgCDX0CyQU2jR4mMskoZgaHhIQAFCOBYxTzBtj/pa6HwIKzk5MT6m5tAY2EB16FmSaoFLY2/gH1KSxKIpCSwX7zzGykp%2bNhUI5ndtMDC4jiIpWdWN8AO57U21SqdDE1EtPdkJbegQh5vPXM8WBiYmLIw7oAHCRYUAFp9ea6AIbPv9QFkpKSjCdOnBAQlsY/ApshLn/w4EFmm/NVHHAejQc7kuBieftIb8d5KqNHbv/ChQuX4U2MGjUKEpCnpqtlwkeNrVOnTlJWCN17hq8lYBIRFkwHA3EiiVSWniOPg9u1a1f%2bvx5GmgpCkPpYuQVzcx5G7IGIc4LMdIEK27Rp09h%2b%2bfLlbOh66623uhDwpabDIJdH8ukyYuNZGQydPj4%2b6Fqq7777jtU1f/5864dBvEExHG0wl5oukmSDmyN6pnumowC96CqfgK/3g/RX0Uz25WxtmiJvJn2%2bTOz3/8G91DVYHTzVzmoAqA9frKnU9dDQUDbRsbCwsEo9gGuDMlWYsSR1xQ2W/h/q95FyTkNdFmqBlQEgvb0jCbw5JJDmJSQkVKD4%2bPj5JPj8SVAuCwsLC6bjOXR%2bvkm5uSQ4YbwgE5oN/q1atXroU/Ts2ZMbRfyB6tNb/IrqMq1fIlyj5/Bv0qTJP3DDkCFD2L29evX6fw%2bOYmpJHWv%2bCzQ%2bS8PiY8aMsTrdhXt/Zs%2bebe2tFQFYs2aNGnY5DYEgnZwiIiLYGyUrr9VLL73EUKe%2bZ0fKilSWRgxtTk4OorpaeiOs5gULFqjatm1rqZuM7SdMmACdBP4BbX5%2bvlnCNfy/zz77jN1DNkjNhMczMzM1cm%2bNjFhhYrlmDg4ObzRr1qyJmTIVTFvqLuwektLyGSK2tFUEwAr31Cyi/7WkIOkItjyRuTIHkALTi5ScdFKIMkkxySDK5ESaYBYpHOmkgh4kOkSN2ye/LlIGnd%2b/b9%2b%2bVOqbncVhSa0YAI4gFbOGNtIFNvHhzc/PTxEA2J05c%2bZ7MfBYxj0xpis74adBtpmu9EQb0%2baIkxK5PLDQQfHYAYBkPSG3zKrx4qVkZrIp4jkAfHkLWwcAQxnjgOvXrxsQkPz9998RfETgkZnCCFwiSFlUVMRWd0MZLIIG0xmhahhIVJYDkMABmDVrljIAoPGXAUCCzABTGMnJZKwIsbGxLBobExPDwtQ0FsMDg2RlFsKGrY4ykZGRsBwNok9AcQBo5RyAtFS8WbxxBB75Mhd82TtcxxuXcwDKkfyo1AUUwwGk0Z2QZWqXywnWqHjM3WPl5ojb6GRcxStNCGqIfc/UwAjIhCfpAskcgEmTJilDDwgPD5948eLFYlJfiy5fvnzTHF26dOk20a0qrhddvXr1JsmLwmXLlmExAxVxleaZZ55RBgDYHB0dmw8cOLBt375923h5eblx8vT0bPvee%2b%2b16Nixo/uzzz7b9d1333WlMm7yMriH7oWLqbGV0V/bAMDC2Rf1VRas2ErDp%2bSkIGCUwwFjx46F0ILyAunNCMf9%2bvVj/rY6deq8U7duXRaB7NOnj5aX4UR2uWb06NESkJaawzYDgHx75ZVXkG%2bjEr07PE8fqdj/o7rv2tWK4WmVAreHA/DJJ/fXMBs8eLAUb9u%2bfXsoXGS8y7i6urKKPvzwwycLgClTWNRZRYJPanxSUlIoH%2btCQkL8OQjEHawyG7X6rAeA%2b%2byHDBkiNT45OTlUFokpF72/EgitW7dWGgjmAZgxY0alxsvevF4MTpSbA4FzgkK6Q9UcMGrUKEmKb926tULjZeGpSiBgw7ogiuaAcePGSR7t1NRUFqQgg4dsHL0UPRYjskhQkEAgS3A2H/dJbigXgIiICDa0ffHFF6N5vg5WcMciZghb80ztHTt2GJG9vWHDBuY8gVU4aNCg13Hv9OnTNYoFAH55cdPScLdONI/1WMcfkWDE5M%2bdO2dERgm%2b73HhwgUmEqgbzOQcIOMiZcqA4cOHSzIgNjZ2vZnJzILMBEZmhmTwv/zyy8qWATzaIl%2bRLSYmZr18MrP4XQ/4CDChgb95dZMmTVilXHtULAfwycxvv/22BEJcXNx6Uz1AzMlhjW/atKnaRIgqWxPky13J5/ZTd/iO8/%2baNWukxjdq1EitQJvg4bYAB6F///5yEMJppAjgjXdyclKLusOTZwzJ%2b3ObNm14d8Bq7w3llZD5%2b2RYg7D%2bqN%2bryc5XYzED7PkxT2hyc3NzoWMWIu/WrZvGtBz23t7e6sDAQFbnsGHDnjiPEBILX3lYoZs3b9bkVPdH2gWeIonewdnZuV3jxo0lor7egYydpvb29jMdHBw%2bxjHOycvgnubNmyMn0EWRPsGwsLDJV65cKS0qKrpVWFh42xwVFxffuH0bh4V3zF2nN3%2bbtMPbwcHBg1FnXl6ephpL3DwWADSnTp2qsbhAZmamFBeogaXvHgkAOh4dRnSn/H68u/x%2bBLxcvufJi9I5k61SZKgaCUyPBQApNohkyAeFx3kev/lLRuXGBjkAJAMMWNObGsGSo5GqjjxiWIPIBUYiCZnDQk5OjvTlx/T0dJZkXVpaqtzwuBwAJEBjRjdC4kiOjo6Oltb0BhjICsfX4QAE2Qlsj9937txRLABShohpFygpKak0d6Dq3qHcLoAcoWxRCJbxxGjxi26M%2bARnnhNkOpFZLFMpR0gpQlBF/f1wTWWJ7dq1K0IEQMONKpsHYO7cuT0zMjLSScjtP3z4cJYp0flMun6U2Pswjs2UySQQD5CsSBk3bhz72kNoaKgy8gStUFvxKUuLEqZ//vlnZanCa9eu1ZAcsD9//rx9bm6uPQ1/EhFLO6A/d%2bnSxdXd3d0FrE3KjoO8DO7BvTRc2gcEBLB/QByjql27tu0DgM9fWbgNJbIqMZ9ngivBGqyzcuXKd6KiooZGREQMkdPGjRuH0lg/wNfXN3jixImzSU94m4ynSuU2b97ss2jRIi%2bVOCmpWbNmyukC27dvX8enz1o7ddZ0Gi2B%2bAUfBfr3768MTfAMdFpR93nIslb6B1y/JxpDqRyA%2bvXrWzKN7VETd/EhhYV9ZEV78uTJE3wRT9k0tQoGkHyiNP/yi2xCs1FUnKAIxSjEN9ia%2bzjxpYZj8uVrhT9XNa2k6EA1xmxOM5tBTJdPg3fJ2dkZCLcTkbYlwjPh2wWYzsKmtg0iaX0BOcCkyJRjwnJSUhKzCDFVFucRGEVeMGaTwkrEF5/wdShcR1kYUHv27CnH9RkzZmBVQ5969er9U61WO4hsVs/GCM/kwFmhAzXuRyRCkygox0fQMV0W%2bcDIEofpi6m0MIVh9pKSw87BVMZvWIji3oAZ36tWrdpDdbZv2bKlk2Ic5aTEHK2B%2bQJ6cWEjSQY4Ojoqov329AbPiv3bIF%2b1wRyZruzAia8hQF0nhY8CNv/1N76R2hrNOeDPecsWvvr7I4Q0YyQxMXEhB0AJGSP/Ba3G3ST7g9goAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="396" data-srcset="/assets/static/triggerVUI.21f6846.42f95b00d8439b19d8b5bf678906c102.svg 396w" data-sizes="(max-width: 396px) 100vw, 396px" data-src="/assets/static/triggerVUI.21f6846.42f95b00d8439b19d8b5bf678906c102.svg"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/triggerVUI.21f6846.42f95b00d8439b19d8b5bf678906c102.svg" width="396"></noscript></p>
<h3 id="trigger-demo"><a href="#trigger-demo" aria-hidden="true"><span class="icon icon-link"></span></a>Trigger Demo</h3>
<p>Same as previous demo but you need to trigger Pumpkin the Parrot by saying "Pumpkin".</p>
<p>Demo: <a href="https://heuristic-hawking-e8bb43.netlify.app/annyang-trigger.html" target="_blank" rel="nofollow noopener noreferrer">https://heuristic-hawking-e8bb43.netlify.app/annyang-trigger.html</a></p>
<h3 id="trigger-flow"><a href="#trigger-flow" aria-hidden="true"><span class="icon icon-link"></span></a>Trigger Flow</h3>
<pre class="language-javascript"><code class="language-javascript">    <span class="token keyword">let</span> vuiActive<span class="token punctuation">,</span> vuiTriggered <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// active when passively listening, triggered when keyword spoken</span>

    <span class="token keyword">const</span> triggerCommand <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">"trigger"</span><span class="token operator">:</span> triggerVUI
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> additionalCommands <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">"How you doing"</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Mind your own business!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">startSpeechRecognition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>annyang<span class="token punctuation">)</span><span class="token punctuation">{</span>
            annyang<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            annyang<span class="token punctuation">.</span><span class="token method function property-access">addCommands</span><span class="token punctuation">(</span>triggerCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// User starts speeking</span>
            annyang<span class="token punctuation">.</span><span class="token method function property-access">addCallback</span><span class="token punctuation">(</span><span class="token string">'soundstart'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                vuiActive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Speech matched a defined command</span>
            annyang<span class="token punctuation">.</span><span class="token method function property-access">addCallback</span><span class="token punctuation">(</span><span class="token string">'resultMatch'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">userSaid<span class="token punctuation">,</span> commandText<span class="token punctuation">,</span> phrases</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>userSaid<span class="token punctuation">.</span><span class="token method function property-access">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'trigger'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    vuiTriggered <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>vuiTriggered<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token function">endTriggerPhase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Speech did NOT match a command</span>
            annyang<span class="token punctuation">.</span><span class="token method function property-access">addCallback</span><span class="token punctuation">(</span><span class="token string">'resultNoMatch'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">phrases</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>vuiTriggered<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token function">endTriggerPhase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            annyang<span class="token punctuation">.</span><span class="token method function property-access">addCallback</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                vuiActive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Say "trigger" to start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Sorry, speech recognition is not available for this browser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">triggerVUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        annyang<span class="token punctuation">.</span><span class="token method function property-access">addCommands</span><span class="token punctuation">(</span>additionalCommands<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//Timeout after no speech</span>
        <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">endListenState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vuiActive <span class="token operator">&amp;&amp;</span> vuiTriggered<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">endTriggerPhase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">function</span> <span class="token function">endTriggerPhase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//if active with no speech not active after being triggered, reset</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>vuiActive <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token operator">!</span>vuiActive <span class="token operator">&amp;&amp;</span> vuiTriggered<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            vuiActive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>vuiTriggered<span class="token punctuation">)</span><span class="token punctuation">{</span>
                vuiTriggered <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

                <span class="token comment">// Grab command part our our command:function pairs</span>
                <span class="token keyword">const</span> commands <span class="token operator">=</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">keys</span><span class="token punctuation">(</span>additionalCommands<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//Remove from annyang (leaves the trigger command there)</span>
                annyang<span class="token punctuation">.</span><span class="token method function property-access">removeCommands</span><span class="token punctuation">(</span>commands<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre>
<p>What we're doing here is just adding in, and then removing, the <code>additionalCommands</code> to annyang to provide some sort of active state to the user.  </p>
<p>The hardest part here is trying to keep track of what state we're in: listening for trigger, listening for a command, timed out with no speech?  We use the <code>vuiActive</code> to keep track on whether annyang is active or not, and then <code>vuiTriggered</code> to show if we're in the "additional commands" phase of our flow.</p>
<h3 id="vui-as-a-progressive-enhancement"><a href="#vui-as-a-progressive-enhancement" aria-hidden="true"><span class="icon icon-link"></span></a>VUI as a Progressive Enhancement</h3>
<p>As this is bleeding edge tech and still in draft status, it's not available on all browsers as standard yet. Added to that, implementation and microphone permission details will vary between browsers.  Your users may also block microphone permissions at any time, even halfway through a session!  As such you'll need to make sure that you're not reliant on this and it's there to be the cherry on top of what you've already got.</p>
<h3 id="thoughts-on-current-tech"><a href="#thoughts-on-current-tech" aria-hidden="true"><span class="icon icon-link"></span></a>Thoughts on current tech</h3>
<p>As you can see with the annyang demos, and indeed the first "native" demo, we're having to try and keep track of what the browser is up to.  Annyang does this for us, but when you have other tabs open with audio, things don't seem to work too well.</p>
<p>The other factor in how well your attempts at voice recognition will work is with the users audio setup.  If you're sitting in a quiet room with a set of headphones and connected microphone, it's not too bad.  Add in a bit of noise, try and use the built in microphone on your laptop/phone and the success rate deteriorates fast!  (Along with your users patience!)</p>
<p>Most smart speakers carry an array of microphones to try and clearly pick up on what you are saying, but even they can falter when trying to detect you in a noisy environment when you're not directly beside it.</p>
<p>This then leads onto mobile users.  How likely are you to, say whilst sitting in a busy coffee shop, speak to your phone while you're browsing the web?  I wouldn't.</p>
<p>The other major factor that plays in to how responsive your voice interface is, will be the users home or mobile internet speed.  The browser records the users speech and then sends it off to some service for translation.  If the user is on a slow connection, this may take some time.  No one likes to wait on anything, so mobile users not in areas where high speed internet is available will likely suffer the most lag in your interface.</p>
<p>It's somewhat ironic that the mobile phone is best equipped to allow for voice interaction, but due to it's mobile (and public) use, will likely have the worst experience!  </p>
<p>This brings us neatly back to the VUI as a progressive enhancement argument: don't rely on it, don't force it upon your user and don't assume your user will ever want to use it!  </p>
<h3 id="further-reading-and-helpful-links"><a href="#further-reading-and-helpful-links" aria-hidden="true"><span class="icon icon-link"></span></a>Further reading and helpful links</h3>
<p>MDN Web Speech API documentation - <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API" target="_blank" rel="nofollow noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API</a></p>
<p>Speech Recognition spec - <a href="https://w3c.github.io/speech-api/" target="_blank" rel="nofollow noopener noreferrer">https://w3c.github.io/speech-api/</a></p>
<p>Annyang, created by Tal Ater - <a href="https://github.com/TalAter/annyang" target="_blank" rel="nofollow noopener noreferrer">https://github.com/TalAter/annyang</a></p>
<p>Voice Applications for Alexa and Google Assistant by Dustin A. Coates - <a href="https://www.manning.com/books/voice-applications-for-alexa-and-google-assistant" target="_blank" rel="nofollow noopener noreferrer">https://www.manning.com/books/voice-applications-for-alexa-and-google-assistant</a></p>
<p>The last link won't go into any of the web API's but it does provide a great foundation into the concepts of building a VUI.</p>
</div><div class="post__footer"><ul class="post-tags inline"><li><a href="/tag/Javascript/" class="post-tags__link"><span>#</span>Javascript</a></li><li><a href="/tag/VUI/" class="post-tags__link"><span>#</span>VUI</a></li><li><a href="/tag/Getting%20Started/" class="post-tags__link"><span>#</span>Getting Started</a></li></ul></div></div><div class="post-comments"><div id="disqus_thread"></div></div></main><footer>
    © 2020 – Huntly Cameron |
    <a href="https://creativecommons.org/licenses/by/4.0/">Content on CC 4.0 License</a></footer></div>
    <script src="/assets/js/app.84a6be26.js" defer></script><script src="/assets/js/page--src--templates--post-vue.9a006d16.js" defer></script>
  </body>
</html>
